import matplotlib.pyplot as plt
import matplotlib.ticker as ticker

plt.rcParams.update({
    'font.size': 18,          # 全局默认字体大小
    # 'axes.titlesize': 16,     # 标题字体大小
    # 'axes.labelsize': 14,     # 坐标轴标签字体大小
    # 'xtick.labelsize': 12,    # x轴刻度字体大小
    # 'ytick.labelsize': 12,    # y轴刻度字体大小
    # 'legend.fontsize': 12     # 图例字体大小
})

revolute_error_traj = {
    "0_1": [10.000000004564, 3.189983044552717, 1.7030189746021533, 0.9911406515109972, 0.7350871846578092, 0.44148223231663053],
    "0_2": [19.999999986852742, 3.008783089177793, 1.7168538580551436, 1.5989991882007006, 0.6997670053914629, 0.6414464106349336],
    "0_3": [30.000000001788223, 6.101384193678161, 4.057437887965217, 2.228962779089337, 0.7496692903505807, 0.7496692903505807],
    "1_0": [10.000000038545526, 0.9364677958397458, 0.42370597084193456, 0.4261882775114695, 0.4293656406763658, 0.3768399571826672],
    "1_2": [9.999999885219914, 1.9863366463779017, 1.289170536637913, 0.913308087701092, 0.9644838670267942, 0.45647696820201833],
    "1_3": [20.000000012556757, 4.6944534222356795, 2.3811595300032327, 1.5050385957132988, 0.6170016173408499, 0.6170016173408499],
    "2_0": [20.000000114558567, 3.3617319122755713, 0.9330211452885094, 0.6515791364834952, 0.6515791364834952, 0.6515791364834952],
    "2_1": [9.999999986662637, 1.279565388135287, 0.4045563120977925, 0.4045563120977925, 0.4045563120977925, 0.4045563120977925],
    "2_3": [9.999999935146294, 3.171962752381734, 3.2619781554230767, 1.7608419618871973, 0.8903573735656054, 0.43955103440021753],
    "3_0": [30.000000072804426, 2.11498527404103, 1.8292477766864725, 1.0988472024215525, 1.0972094849632201, 1.0997281588671572],
    "3_1": [19.99999985263736, 2.434727849982352, 1.0386793089681747, 0.9538961246508798, 0.8815580065006161, 0.6953745029392506],
    "3_2": [9.999999786177657, 2.9176819881077183, 0.607368717474677, 0.41185883733068857, 0.4678979958345896, 0.4173333464990774]
}

prismatic_error_traj = {
    "0_1": [10.000000010182005, 0.4792918529546377, 0.41695094839641056, 0.35805983217827714, 0.35805983217827714, 0.35805983217827714],
    "0_2": [20.00000000832703, 3.518320025475409, 0.41758313132054986, 0.5944707428686559, 0.8112872410422636, 0.3777815337253351],
    "0_3": [29.999999983870392, 7.525886273140429, 2.4468262241012617, 0.6988604720568145, 0.3672178864800493, 0.3672178864800493],
    "1_0": [9.999999948932425, 0.45176683738337375, 0.24834679563532697, 0.24834679563532697, 0.24834679563532697, 0.24834679563532697],
    "1_2": [9.99999994980921, 1.3623029506386968, 0.9933690197247863, 0.6086917616183588, 0.37888713916538264, 0.37888713916538264],
    "1_3": [20.000000035105302, 2.100295561666983, 0.6695124829630473, 0.38164836060319784, 0.38164836060319784, 0.3732223040224508],
    "2_0": [19.999999919733163, 2.019854576038606, 0.5237514855025237, 0.3205850022326626, 0.32010996582546264, 0.3205850022326626],
    "2_1": [10.00000009655155, 0.8412146428889413, 0.5806606488309565, 0.34920525515024436, 0.34920525515024436, 0.34920525515024436],
    "2_3": [10.000000224487572, 3.45573011792998, 0.7081761627627972, 0.5120001404716137, 0.4212387454098963, 0.4212387454098963],
    "3_0": [30.00000016264139, 4.58851896540251, 1.5870070370088087, 0.32665444924290493, 0.259818879389798, 0.259818879389798],
    "3_1": [20.000000064945503, 4.084873252200829, 1.8735794083901331, 0.9315280791420292, 0.3187020008459196, 0.3177342612871182],
    "3_2": [9.999999997659495, 1.1593712464843098, 0.28855806635813397, 0.28855806635813397, 0.28855806635813397, 0.28855806635813397]
}

def plot_closed_loop(error_traj_dict, save_name, unit):
    plt.figure(figsize=(10, 6))

    # 遍历字典，绘制每条曲线
    for key, value in error_traj_dict.items():
        import math
        value = value[1:]
        # value = [math.log(x) for x in value]
        plt.plot(range(1, 6), value, label=key, marker='o')

    # 添加图例
    plt.legend(ncol=2)

    # 添加标题和轴标签
    # plt.title('Error Trajectories for Different i_j Pairs')
    plt.xlabel('Number of Manipulations (times)')
    plt.ylabel(f'Manipulation Error ({unit})')
    
    plt.gca().xaxis.set_major_locator(ticker.MaxNLocator(integer=True))

    plt.grid(True, alpha=0.3)
    # 显示图形
    # plt.show()
    plt.savefig(f"./{save_name}.png")
    
    

if __name__ == "__main__":
    plot_closed_loop(error_traj_dict=revolute_error_traj, save_name="revolute_closed_loop", unit="°")
    plot_closed_loop(error_traj_dict=prismatic_error_traj, save_name="prismatic_closed_loop", unit="cm")